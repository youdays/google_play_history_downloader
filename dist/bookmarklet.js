javascript:(()=>{const a=()=>{return t=3,new Promise(e=>{setTimeout(()=>{e()},1e3*t)});var t},l=()=>{var e=document.documentElement,e=e.scrollHeight-e.clientHeight;window.scroll(0,e)},o=()=>document.documentElement.scrollHeight,r=()=>document.getElementsByClassName("NVOyre")[0].querySelector('[role="button"]'),c=()=>document.getElementsByClassName("U6fuTe"),s=e=>{return{img:e.getElementsByClassName("T75of")[0].getAttribute("src"),date:e.getElementsByClassName("goeMJb")[0].textContent,detail:e.getElementsByClassName("XqqpEd")[0].textContent,price:e.getElementsByClassName("mshXob")[0].textContent.replace(/[^0-9]/g,"")}},t=e=>'"'+e.replaceAll('"','""')+'"';(async()=>{confirm("CSVファイルを作る前にすべての履歴を読み込みますか?")&&(alert("すべての履歴を読み込みます。しばらく画面が動きますが、CSV完成までそのままお待ち下さい。"),await(async()=>{let e=o();for(;;){l(),await a();const n=r();n&&(n.click(),await a());var t=o();if(t===e)break;e=t}})());var e="date, price, img, detail\n"+(()=>{const t=[];var n=c();for(let e=0;e<n.length;e++){var a=n[e];t.push(s(a))}return t})().map(e=>[e.date,e.price,e.img,e.detail].map(t).join(",")).join("\n");(e=>{var t=`google_play_history_${(new Date).getTime()}.csv`,n=new Uint8Array([239,187,191]),e=new Blob([n,e],{type:"text/csv"});const a=document.createElement("a");e=URL.createObjectURL(e);a.href=e,a.download=t,a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(e)})(e)})()})();
